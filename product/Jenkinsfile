pipeline {
  agent any
  stages {
    stage('Test Docker Images Locally') {
      steps {
        sh '''cd product
              ansible-playbook image_creator.yml --tags image_test'''
      }
    }

    stage('Perform tests using docker Images from Dockerhub') {
      steps {
        sh '''cd product
              export ANSIBLE_HOST_KEY_CHECKING=False
              ansible-playbook -i test_inventory image_tester.yml --tags image_test '''
      }
    }
  }
}